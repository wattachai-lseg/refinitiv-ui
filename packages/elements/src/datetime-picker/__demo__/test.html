<!DOCTYPE html>
<html lang="en-GB">
  <head>
    <meta charset="utf-8" />
    <title>Datetime Picker</title>
    <style type="text/css">
      ef-datetime-picker[range][timepicker] {
        width: 400px;
      }
      demo-block {
        width: 1400px;
      }
      ef-text-field,
      ef-select {
        width: 300px;
      }
    </style>
  </head>
  <body>
    <script type="module">
      import '@refinitiv-ui/elements/button';
      import '@refinitiv-ui/elements/checkbox';
      import '@refinitiv-ui/elements/datetime-picker';
      import '@refinitiv-ui/elements/item';
      import '@refinitiv-ui/elements/radio-button';
      import '@refinitiv-ui/elements/select';

      import '@refinitiv-ui/demo-block';
      import '@refinitiv-ui/demo-block/demo.css';

      // Dynamic import theme files from search params of the URL
      // Ex. http://localhost:3000?theme=halo&varint=dark will load halo-theme/dark
      const url = new URL(window.location);
      const theme = url.searchParams.get('theme') || 'halo';
      const variant = url.searchParams.get('variant') || 'light';

      if (!window.location.search) {
        url.searchParams.set('theme', theme);
        url.searchParams.append('variant', variant);
        window.location.search = url.searchParams.toString();
      }

      import(`../../../../../node_modules/@refinitiv-ui/${theme}-theme/${variant}/css/native-elements.css`);
      import(`../../../lib/datetime-picker/themes/${theme}/${variant}/index.js`);
      import(`../../../lib/button/themes/${theme}/${variant}/index.js`);
      import(`../../../lib/checkbox/themes/${theme}/${variant}/index.js`);
      import(`../../../lib/select/themes/${theme}/${variant}/index.js`);
      import(`../../../lib/item/themes/${theme}/${variant}/index.js`);
      import(`../../../lib/radio-button/themes/${theme}/${variant}/index.js`);
    </script>
    <demo-block header="Custom Slots" tags="slot">
      <style type="text/css">
        .bg {
          background-color: lightsalmon;
          width: 100%;
          height: 100%;
        }

        .bg2 {
          background-color: lightgreen;
          width: 100%;
          height: 100%;
        }
      </style>

      <ef-datetime-picker id="default-range" range duplex="split" timepicker> </ef-datetime-picker>
      <script type="module">
        const el = document.getElementById('default-range');

        const appendSlot = (el, node) => {
          const div = document.createElement('div');
          div.innerHTML = el.innerHTML;
          div.append(node);
          el.innerHTML = div.innerHTML;
        };

        const createSlot = (el, event, target, text, css) => {
          if (event.detail.calendar === target.calendar && event.detail.cell.value === target.date) {
            const newSlot = document.createElement('div');
            newSlot.slot = `${target.calendar === 'calendar' ? 'calendar-from' : target.calendar}-${
              target.date
            }`;
            newSlot.classList.add(css);
            newSlot.innerText = text;
            appendSlot(el, newSlot);
          }
        };

        el.addEventListener('before-cell-render', (event) => {
          console.log(event.detail.calendar, event.detail.cell);

          createSlot(el, event, { calendar: 'calendar', date: '2023-10-10' }, 'üêõ', 'bg');
          createSlot(el, event, { calendar: 'calendar-to', date: '2023-11-11' }, 'üï∑Ô∏è', 'bg');

          let i = 12;
          setInterval(() => {
            createSlot(el, event, { calendar: 'calendar-to', date: '2023-11-' + i }, 'üêû', 'bg2');
            i++;
          }, 3000);
        });
      </script>
    </demo-block>
  </body>
</html>
